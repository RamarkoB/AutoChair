<!DOCTYPE html>
<head>
    <title>Ramarko's Auto Chair</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="http://hilios.github.io/jQuery.countdown/" class="text-muted"></a>
    <link href="style.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
</head>

<html>
	<!-- Countdown -->
	<div class="col-lg-8 mx-auto">
		<div class="my-2 countdown py-4 rounded text-center border border-dark">
			<div>
				<p class="timer-active"><span id="timer-min" class="h1 font-weight-bold"></span> Min <span id="timer-sec" class="h1 font-weight-bold"></span> sec</p>
			</div>
			
			<!-- Call to actions -->
			<ul class="list-inline">
				<li class="list-inline-item">
					<button id="btn-reset" type="button" class="btn btn-demo"><i class="glyphicon glyphicon-repeat"></i>Reset</button>
				</li>
				<li class="list-inline-item">
					<button id="btn-pause-resume" type="button" class="btn btn-demo"><i class="glyphicon glyphicon-repeat"></i>Pause</button>
				</li>
			</ul>
		</div>
	
		<!-- Countdown-->
		<div class="my-2 countdown-inactive rounded text-center border border-dark">
			<div class="countdown py-4">
				<p class="timer-inactive" style="color:gray"><input class="timer-minutes" placeholder="00" maxlength="2" pattern="\d*"></input> min 
					<input class="timer-seconds" placeholder="00" maxlength="2" pattern="\d*"></input> sec</p>
			</div>
			
			<!-- Call to actions -->
			<ul class="list-inline">
				<li class="list-inline-item">
					<button type="button" class="btn btn-demo"><i class="btn-timer-reset glyphicon glyphicon-repeat"></i>Reset</button>
				</li>
				<li class="list-inline-item">
					<button type="button" class="btn btn-demo btn-timer-multiuse"><i class="glyphicon glyphicon-repeat"></i>Start</button>
				</li>
			</ul>
		</div>
	</div>
</html>

<script>

const countdowns = document.getElementsByClassName("countdown-inactive");
for (let i = 0; i < countdowns.length; i++) {
	const countdown = countdowns[0];
	const btn = countdown.getElementsByClassName("btn-timer-multiuse")[0];
	btn.addEventListener("click", function() {
		const minutes = parseInt(countdown.getElementsByClassName("timer-minutes")[0]);
		const seconds = parseInt(countdown.getElementsByClassName("timer-seconds")[0]);
		const deadline = new Date(current_time + minutes*60*1000);
		console.log(deadline);
		run_clock(deadline);
	})
	console.log(btn);
}



function time_remaining(endtime){
	var t = Date.parse(endtime) - Date.parse(new Date());
	var seconds = Math.floor( (t/1000) % 60 );
	var minutes = Math.floor( (t/1000/60) % 60 );
	var hours = Math.floor( (t/(1000*60*60)) % 24 );
	var days = Math.floor( t/(1000*60*60*24) );
	return {'total':t, 'days':days, 'hours':hours, 'minutes':minutes, 'seconds':seconds};
}

// 10 minutes from now
var time_in_minutes = 10;
var current_time = Date.parse(new Date());
var deadline = new Date(current_time + time_in_minutes*60*1000);

var timeinterval;
function run_clock(endtime){
	function update_clock(){
		var t = time_remaining(endtime);
		const minutes = document.getElementById("timer-min");
		const seconds = document.getElementById("timer-sec");
		minutes.innerText = t.minutes;
		seconds.innerText = t.seconds;
		if(t.total<=0){ clearInterval(timeinterval); }
	}
	update_clock(); // run function once at first to avoid delay
	timeinterval = setInterval(update_clock,1000);
}



var paused = false; // is the clock paused?
var time_left; // time left on the clock when paused


// handle pause and resume button clicks
document.getElementById("btn-pause-resume").addEventListener("click", function(e){
	const pauseresume = document.getElementById("btn-pause-resume")

	if (paused){
		paused = false;
		pauseresume.innerText = "Pause";

		// update the deadline to preserve the amount of time remaining
		deadline = new Date(Date.parse(new Date()) + time_left);

		// start the clock
		run_clock(deadline);
	}
	else if (!paused){
		paused = true;
		document.getElementById("btn-pause-resume");
		pauseresume.innerText = "Resume";

		 // stop the clock
		clearInterval(timeinterval);

		// preserve remaining time
		time_left = time_remaining(deadline).total; 
	}

})


</script>